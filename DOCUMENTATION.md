# التوثيق الفني لأداة YtubeData

<div dir="rtl">

## نظرة عامة على الهيكل

تتكون أداة YtubeData من عدة مكونات رئيسية تعمل معاً لاستخراج البيانات الوصفية من يوتيوب وعرضها بطرق مختلفة. هذا التوثيق يشرح الهيكل الداخلي للأداة والوظائف الرئيسية.

## المكونات الرئيسية

### 1. الدوال المساعدة

#### `format_date(date_str)`

تقوم هذه الدالة بتنسيق التاريخ من الصيغة التي يوفرها يوتيوب (YYYYMMDD) إلى صيغة أكثر قابلية للقراءة (YYYY-MM-DD).

- **المدخلات**: سلسلة نصية تمثل التاريخ بصيغة YYYYMMDD
- **المخرجات**: سلسلة نصية تمثل التاريخ بصيغة YYYY-MM-DD

#### `format_duration(duration_seconds)`

تقوم هذه الدالة بتحويل مدة الفيديو من ثواني إلى تنسيق ساعات:دقائق:ثواني.

- **المدخلات**: عدد صحيح يمثل المدة بالثواني
- **المخرجات**: سلسلة نصية تمثل المدة بتنسيق HH:MM:SS أو MM:SS

#### `format_number(number)`

تقوم هذه الدالة بتنسيق الأرقام بإضافة فواصل للآلاف لتسهيل قراءتها.

- **المدخلات**: عدد صحيح
- **المخرجات**: سلسلة نصية تمثل العدد مع فواصل الآلاف

### 2. دوال استخراج البيانات

#### `get_video_metadata(url)`

تقوم هذه الدالة باستخراج البيانات الوصفية للفيديو من الرابط المعطى.

- **المدخلات**: رابط فيديو يوتيوب
- **المخرجات**: قاموس (dictionary) يحتوي على البيانات الوصفية للفيديو

**البيانات المستخرجة**:

- عنوان الفيديو
- وصف الفيديو
- معرف الفيديو
- اسم القناة
- رابط القناة
- معرف القناة
- تاريخ النشر
- مدة الفيديو (بالثواني وبتنسيق منسق)
- عدد المشاهدات
- تقييم الفيديو
- الكلمات المفتاحية
- معلومات عن مناسبة الفيديو للعائلة
- معلومات عن القيود العمرية
- رابط صورة الغلاف
- معلومات عن الدقة المتاحة وأحجام الملفات

#### `get_channel_metadata(url)`

تقوم هذه الدالة باستخراج البيانات الوصفية للقناة من الرابط المعطى.

- **المدخلات**: رابط قناة يوتيوب
- **المخرجات**: قاموس (dictionary) يحتوي على البيانات الوصفية للقناة

**البيانات المستخرجة**:

- اسم القناة
- معرف القناة
- وصف القناة
- رابط القناة
- معلومات عن آخر 5 فيديوهات منشورة

### 3. دوال عرض البيانات

#### `display_video_metadata(metadata, output_format, output_file)`

تقوم هذه الدالة بعرض البيانات الوصفية للفيديو بالتنسيق المطلوب.

- **المدخلات**:
  - `metadata`: قاموس يحتوي على البيانات الوصفية للفيديو
  - `output_format`: تنسيق الإخراج (console, json, csv)
  - `output_file`: اسم ملف الإخراج (اختياري)

#### `display_channel_metadata(metadata, output_format, output_file)`

تقوم هذه الدالة بعرض البيانات الوصفية للقناة بالتنسيق المطلوب.

- **المدخلات**:
  - `metadata`: قاموس يحتوي على البيانات الوصفية للقناة
  - `output_format`: تنسيق الإخراج (console, json, csv)
  - `output_file`: اسم ملف الإخراج (اختياري)

### 4. الدالة الرئيسية

#### `main()`

الدالة الرئيسية التي تقوم بمعالجة المدخلات من سطر الأوامر وتنفيذ العمليات المطلوبة.

## تدفق البيانات

1. يقوم المستخدم بتوفير رابط فيديو أو قناة يوتيوب مع خيارات إضافية
2. تقوم الدالة الرئيسية `main()` بتحليل المدخلات وتحديد نوع العملية المطلوبة
3. يتم استدعاء دالة استخراج البيانات المناسبة (`get_video_metadata` أو `get_channel_metadata`)
4. تقوم دالة استخراج البيانات بالاتصال بيوتيوب واستخراج البيانات المطلوبة
5. يتم تمرير البيانات المستخرجة إلى دالة العرض المناسبة (`display_video_metadata` أو `display_channel_metadata`)
6. تقوم دالة العرض بعرض البيانات بالتنسيق المطلوب (وحدة التحكم، JSON، CSV)

## المكتبات المستخدمة

- **pytube**: المكتبة الرئيسية المستخدمة لاستخراج البيانات من يوتيوب
- **rich**: مكتبة لتنسيق النصوص وعرض الجداول في وحدة التحكم
- **pandas**: مكتبة لمعالجة البيانات وتصديرها بتنسيق CSV
- **tabulate**: مكتبة لعرض البيانات في جداول منسقة
- **pytz**: مكتبة للتعامل مع المناطق الزمنية

## آلية استخراج البيانات

تعتمد الأداة على مكتبة pytube لاستخراج البيانات من يوتيوب. تقوم هذه المكتبة بتحليل صفحة الفيديو أو القناة واستخراج البيانات المطلوبة دون الحاجة إلى مفتاح API.

### استخراج بيانات الفيديو

1. إنشاء كائن `YouTube` باستخدام رابط الفيديو
2. استخراج البيانات الأساسية مثل العنوان والوصف والمدة وعدد المشاهدات
3. استخراج معلومات الدقة المتاحة من خلال تصفية الدفق المتاح

### استخراج بيانات القناة

1. إنشاء كائن `Channel` باستخدام رابط القناة
2. استخراج البيانات الأساسية مثل اسم القناة والوصف
3. استخراج معلومات آخر 5 فيديوهات منشورة

## معالجة الأخطاء

تتضمن الأداة آليات لمعالجة الأخطاء المحتملة مثل:

- روابط غير صالحة
- فيديوهات غير متاحة
- أخطاء اتصال
- أخطاء غير متوقعة

في حالة حدوث خطأ، تقوم الأداة بعرض رسالة خطأ واضحة للمستخدم مع معلومات إضافية عن سبب الخطأ إن أمكن.

## تنسيقات الإخراج

### وحدة التحكم (Console)

عند اختيار تنسيق الإخراج `console`، تقوم الأداة بعرض البيانات في جداول منسقة باستخدام مكتبة rich. يتم عرض البيانات الأساسية في جدول رئيسي، ومعلومات إضافية (مثل الدقة المتاحة أو آخر الفيديوهات) في جداول منفصلة.

### JSON

عند اختيار تنسيق الإخراج `json`، تقوم الأداة بتصدير البيانات بتنسيق JSON. يمكن حفظ البيانات في ملف إذا تم توفير اسم الملف، أو عرضها في وحدة التحكم إذا لم يتم توفير اسم الملف.

### CSV

عند اختيار تنسيق الإخراج `csv`، تقوم الأداة بتصدير البيانات الأساسية بتنسيق CSV. يتم تصدير البيانات الإضافية (مثل الدقة المتاحة أو آخر الفيديوهات) في ملف منفصل إذا تم توفير اسم الملف.

## واجهة سطر الأوامر

توفر الأداة واجهة سطر أوامر بسيطة وسهلة الاستخدام. يمكن للمستخدم توفير المعلومات التالية:

- رابط فيديو أو قناة يوتيوب (مطلوب)
- نوع الرابط (فيديو أو قناة)
- تنسيق الإخراج (وحدة التحكم، JSON، CSV)
- اسم ملف الإخراج (اختياري)

## ملاحظات تقنية

- تعتمد الأداة على واجهة يوتيوب العامة، لذلك قد تتأثر بأي تغييرات في هيكل صفحات يوتيوب
- بعض البيانات (مثل عدد المشتركين في القناة) قد لا تكون متاحة بسبب قيود يوتيوب
- تم تصميم الأداة لتعمل مع أحدث إصدار من مكتبة pytube

## التوافق

- تم اختبار الأداة على Python 3.6 وأحدث
- تعمل الأداة على أنظمة التشغيل Windows و macOS و Linux
- تدعم الأداة اللغة العربية بشكل كامل

## الأداء

- يعتمد وقت استخراج البيانات على سرعة الاتصال بالإنترنت وحجم البيانات المطلوبة
- استخراج بيانات الفيديو عادة ما يكون أسرع من استخراج بيانات القناة
- استخراج بيانات القناة قد يستغرق وقتاً أطول إذا كان هناك عدد كبير من الفيديوهات

</div>